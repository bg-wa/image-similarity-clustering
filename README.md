# Unsupervised ML with Keras pre-trained models and t-SNE
This project allows images to be automatically grouped into like 
clusters using a combination of machine learning techniques.

Unsupervised machine learning is a technique that can used to 
automatically classify or group data together that has no preidentified 
structure (as opposed to supervised learning where an "expert" has 
labeled a training data set).

There are two steps involved in the process. The first is to use a 
pre-trained deep learning model to extract a **feature vector** of each 
image in the collection. Once we have the vector 
(which is an array of floating point values) it is then be passed into a
t-SNE function, which takes all of the arrays and reduces them down to 
two values: **X** and **Y**. These two values can then be plotted 
against each other to produce a graph which Zegami can use as a filter.

## extract.py
Uses one of the [pre-trained deep learning models avaliable in 
Keras](https://keras.io/applications) to extract a feature vector for 
all images in a source directory.

I used the following guide to 
[install Keras with TensorFlow](https://keras.io/#installation) using 
conda.

The script expects as arguments:  

1. The path to a tab separated file that has at a minimum a column 
called 'id' and another called 'image' which contains the file name. 

Specify your source file .tsv with the `--source` option.

2. The path to a tab separated file as the output of the extract
 process. 

Specify your output file .tsv with the `--output` option.

3. The path you your images, named in the source file.

Specify your image directory with the `--image_path` option.

*Example:*
```
extract.py --source example.tsv --output features.tsv --image_path 'images'
```

## tsne.py
Takes a comma separated list of values, from the process above and runs 
them through a t-SNE function. The result is then saved back to a tab 
separated file.

The script expects as arguments:  

1. The path to a tab separated file that has been generated by 
extract.py. 

Specify your source file .tsv with the `--source` option.

2. The path to a tab separated file as the output of the tsne process. 

Specify your output file .tsv with the `--output` option.

*Example:*
```
extract.py --source features.tsv --output feature_plots.tsv
```